{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\realtime-editor\\\\src\\\\components\\\\Editor.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport codemirror from 'codemirror';\nimport './../App.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/theme/dracula.css';\nimport 'codemirror/mode/javascript/javascript';\nimport 'codemirror/addon/edit/closebrackets';\nimport ACTIONS from '../Action';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Editor = _ref => {\n  _s();\n  let {\n    roomid,\n    socketref,\n    oncodechange\n  } = _ref;\n  const editorref = useRef(null);\n  useEffect(() => {\n    async function init() {\n      editorref.current = codemirror.fromTextArea(document.getElementById('realtimeeditor'), {\n        mode: {\n          name: 'javascript',\n          json: true\n        },\n        theme: 'dracula',\n        autoCloseTags: true,\n        autoCloseBrackets: true,\n        lineNumbers: true\n      });\n      editorref.current.on('change', (instances, changes) => {\n        const {\n          origin\n        } = changes;\n        const code = instances.getValue();\n        oncodechange(code);\n        if (origin !== 'setValue') {\n          socketref.current.emit(ACTIONS.CODE_CHANGE, {\n            roomid,\n            code\n          });\n        }\n      });\n    }\n    init();\n  }, []);\n  useEffect(() => {\n    if (socketref.current) {\n      console.log(\"changeee\");\n      socketref.current.on(ACTIONS.CODE_CHANGE, _ref2 => {\n        let {\n          code\n        } = _ref2;\n        if (code !== null) {\n          editorref.current.setValue(code);\n        }\n      });\n    }\n    return () => {\n      socketref.current.off(ACTIONS.CODE_CHANGE);\n    };\n  }, [socketref.current]);\n  return /*#__PURE__*/_jsxDEV(\"textarea\", {\n    id: \"realtimeeditor\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 10\n  }, this);\n  //  <textarea name=\"\" id=\"\" cols=\"30\" rows=\"10\"></textarea>\n};\n_s(Editor, \"6bJfeIEnPsC0gkGN2+UAHVipwqw=\");\n_c = Editor;\nexport default Editor;\nvar _c;\n$RefreshReg$(_c, \"Editor\");","map":{"version":3,"names":["React","useEffect","useRef","codemirror","ACTIONS","jsxDEV","_jsxDEV","Editor","_ref","_s","roomid","socketref","oncodechange","editorref","init","current","fromTextArea","document","getElementById","mode","name","json","theme","autoCloseTags","autoCloseBrackets","lineNumbers","on","instances","changes","origin","code","getValue","emit","CODE_CHANGE","console","log","_ref2","setValue","off","id","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/ASUS/Desktop/realtime-editor/src/components/Editor.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react'\r\nimport codemirror from 'codemirror';\r\nimport './../App.css';\r\nimport 'codemirror/lib/codemirror.css';\r\nimport 'codemirror/theme/dracula.css';\r\nimport 'codemirror/mode/javascript/javascript';\r\nimport 'codemirror/addon/edit/closebrackets';\r\nimport ACTIONS from '../Action';\r\nconst Editor = ({roomid , socketref,oncodechange}) => {\r\n  const editorref = useRef(null);\r\n  useEffect(()=>{\r\n    async function init(){\r\n      editorref.current = codemirror.fromTextArea(document.getElementById('realtimeeditor'),{\r\n        mode:{name:'javascript',json:true},\r\n        theme:'dracula',\r\n        autoCloseTags:true,\r\n        autoCloseBrackets :true,\r\n        lineNumbers:true,\r\n      });\r\n\r\n      editorref.current.on('change' , (instances,changes)=>{\r\n        const {origin} = changes;\r\n        const code = instances.getValue();\r\n    \r\n        oncodechange(code);\r\n        \r\n        if(origin!== 'setValue'){\r\n          socketref.current.emit(ACTIONS.CODE_CHANGE , {\r\n            roomid,\r\n            code,\r\n          })\r\n        }\r\n\r\n      })\r\n\r\n     \r\n\r\n    }\r\n    init();\r\n  },[]);\r\n\r\n  useEffect(()=>{\r\n\r\n    if(socketref.current){\r\n      console.log(\"changeee\")\r\n      socketref.current.on(ACTIONS.CODE_CHANGE , ({code})=>{\r\n        if(code!==null){\r\n          \r\n          editorref.current.setValue(code);\r\n        }\r\n      })\r\n    }\r\n    return ()=>{\r\n      socketref.current.off(ACTIONS.CODE_CHANGE)\r\n    }\r\n    \r\n  },[socketref.current])\r\n  return <textarea id=\"realtimeeditor\" ></textarea>;\r\n//  <textarea name=\"\" id=\"\" cols=\"30\" rows=\"10\"></textarea>\r\n  \r\n};\r\n\r\nexport default Editor;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAChD,OAAOC,UAAU,MAAM,YAAY;AACnC,OAAO,cAAc;AACrB,OAAO,+BAA+B;AACtC,OAAO,8BAA8B;AACrC,OAAO,uCAAuC;AAC9C,OAAO,qCAAqC;AAC5C,OAAOC,OAAO,MAAM,WAAW;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAChC,MAAMC,MAAM,GAAGC,IAAA,IAAuC;EAAAC,EAAA;EAAA,IAAtC;IAACC,MAAM;IAAGC,SAAS;IAACC;EAAY,CAAC,GAAAJ,IAAA;EAC/C,MAAMK,SAAS,GAAGX,MAAM,CAAC,IAAI,CAAC;EAC9BD,SAAS,CAAC,MAAI;IACZ,eAAea,IAAIA,CAAA,EAAE;MACnBD,SAAS,CAACE,OAAO,GAAGZ,UAAU,CAACa,YAAY,CAACC,QAAQ,CAACC,cAAc,CAAC,gBAAgB,CAAC,EAAC;QACpFC,IAAI,EAAC;UAACC,IAAI,EAAC,YAAY;UAACC,IAAI,EAAC;QAAI,CAAC;QAClCC,KAAK,EAAC,SAAS;QACfC,aAAa,EAAC,IAAI;QAClBC,iBAAiB,EAAE,IAAI;QACvBC,WAAW,EAAC;MACd,CAAC,CAAC;MAEFZ,SAAS,CAACE,OAAO,CAACW,EAAE,CAAC,QAAQ,EAAG,CAACC,SAAS,EAACC,OAAO,KAAG;QACnD,MAAM;UAACC;QAAM,CAAC,GAAGD,OAAO;QACxB,MAAME,IAAI,GAAGH,SAAS,CAACI,QAAQ,EAAE;QAEjCnB,YAAY,CAACkB,IAAI,CAAC;QAElB,IAAGD,MAAM,KAAI,UAAU,EAAC;UACtBlB,SAAS,CAACI,OAAO,CAACiB,IAAI,CAAC5B,OAAO,CAAC6B,WAAW,EAAG;YAC3CvB,MAAM;YACNoB;UACF,CAAC,CAAC;QACJ;MAEF,CAAC,CAAC;IAIJ;IACAhB,IAAI,EAAE;EACR,CAAC,EAAC,EAAE,CAAC;EAELb,SAAS,CAAC,MAAI;IAEZ,IAAGU,SAAS,CAACI,OAAO,EAAC;MACnBmB,OAAO,CAACC,GAAG,CAAC,UAAU,CAAC;MACvBxB,SAAS,CAACI,OAAO,CAACW,EAAE,CAACtB,OAAO,CAAC6B,WAAW,EAAGG,KAAA,IAAU;QAAA,IAAT;UAACN;QAAI,CAAC,GAAAM,KAAA;QAChD,IAAGN,IAAI,KAAG,IAAI,EAAC;UAEbjB,SAAS,CAACE,OAAO,CAACsB,QAAQ,CAACP,IAAI,CAAC;QAClC;MACF,CAAC,CAAC;IACJ;IACA,OAAO,MAAI;MACTnB,SAAS,CAACI,OAAO,CAACuB,GAAG,CAAClC,OAAO,CAAC6B,WAAW,CAAC;IAC5C,CAAC;EAEH,CAAC,EAAC,CAACtB,SAAS,CAACI,OAAO,CAAC,CAAC;EACtB,oBAAOT,OAAA;IAAUiC,EAAE,EAAC;EAAgB;IAAAC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,QAAa;EACnD;AAEA,CAAC;AAAClC,EAAA,CApDIF,MAAM;AAAAqC,EAAA,GAANrC,MAAM;AAsDZ,eAAeA,MAAM;AAAC,IAAAqC,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}